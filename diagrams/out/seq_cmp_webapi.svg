<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="449px" preserveAspectRatio="none" style="width:787px;height:449px;" version="1.1" viewBox="0 0 787 449" width="787px" zoomAndPan="magnify"><defs><filter height="300%" id="fknrwawonl0ks" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="29.1328" style="stroke: #76B82A; stroke-width: 1.0;" width="10" x="538.5" y="154.3203"/><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="29.1328" style="stroke: #76B82A; stroke-width: 1.0;" width="10" x="684.5" y="300.9844"/><rect fill="#FFFFFF" filter="url(#fknrwawonl0ks)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="607.5" x="13" y="116.0547"/><rect fill="#FFFFFF" filter="url(#fknrwawonl0ks)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="755.5" x="13" y="262.7188"/><line style="stroke: #76B82A; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="61" x2="61" y1="41.7891" y2="397.25"/><line style="stroke: #76B82A; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="381.5" x2="381.5" y1="41.7891" y2="397.25"/><line style="stroke: #76B82A; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="543.5" x2="543.5" y1="41.7891" y2="397.25"/><line style="stroke: #76B82A; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="689.5" x2="689.5" y1="41.7891" y2="397.25"/><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="73" x="23" y="3"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="59" x="30" y="25.7798">CMP JS</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="73" x="23" y="396.25"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="59" x="30" y="419.0298">CMP JS</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="166" x="296.5" y="3"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="152" x="303.5" y="25.7798">Permission Layer</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="166" x="296.5" y="396.25"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="152" x="303.5" y="419.0298">Permission Layer</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="130" x="476.5" y="3"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="116" x="483.5" y="25.7798">Read Service</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="130" x="476.5" y="396.25"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="116" x="483.5" y="419.0298">Read Service</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="134" x="620.5" y="3"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="120" x="627.5" y="25.7798">Write Service</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="33.7891" style="stroke: #76B82A; stroke-width: 1.5;" width="134" x="620.5" y="396.25"/><text fill="#FFFFFF" font-family="Arial" font-size="17" lengthAdjust="spacingAndGlyphs" textLength="120" x="627.5" y="419.0298">Write Service</text><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="29.1328" style="stroke: #76B82A; stroke-width: 1.0;" width="10" x="538.5" y="154.3203"/><rect fill="#76B82A" filter="url(#fknrwawonl0ks)" height="29.1328" style="stroke: #76B82A; stroke-width: 1.0;" width="10" x="684.5" y="300.9844"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="61.5" x2="103.5" y1="88.0547" y2="88.0547"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="103.5" x2="103.5" y1="88.0547" y2="101.0547"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="62.5" x2="103.5" y1="101.0547" y2="101.0547"/><polygon fill="#76B82A" points="72.5,97.0547,62.5,101.0547,72.5,105.0547,68.5,101.0547" style="stroke: #76B82A; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="68.5" y="75.4224">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="103.5" y="67.856">Check local/cached status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="107.5" y="82.9888">Unknown user, no privacy status known</text><path d="M13,116.0547 L458,116.0547 L458,123.0547 L448,133.0547 L13,133.0547 L13,116.0547 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="607.5" x="13" y="116.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="400" x="28" y="129.1216">Check Status (privacy settings, user authentication)</text><polygon fill="#76B82A" points="526.5,150.3203,536.5,154.3203,526.5,158.3203,530.5,154.3203" style="stroke: #76B82A; stroke-width: 1.0;"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="61.5" x2="532.5" y1="154.3203" y2="154.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="68.5" y="149.2544">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="331" x="103.5" y="149.2544">try to retrieve privacy status for authenticated user</text><polygon fill="#76B82A" points="72.5,179.4531,62.5,183.4531,72.5,187.4531,68.5,183.4531" style="stroke: #76B82A; stroke-width: 1.0;"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="66.5" x2="542.5" y1="183.4531" y2="183.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="78.5" y="178.3872">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="404" x="112.5" y="178.3872">response - OK, CONSENT_REQUIRED, no privacy status present</text><line style="stroke: #76B82A; stroke-width: 1.0;" x1="61.5" x2="103.5" y1="234.7188" y2="234.7188"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="103.5" x2="103.5" y1="234.7188" y2="247.7188"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="62.5" x2="103.5" y1="247.7188" y2="247.7188"/><polygon fill="#76B82A" points="72.5,243.7188,62.5,247.7188,72.5,251.7188,68.5,247.7188" style="stroke: #76B82A; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="68.5" y="222.0864">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="103.5" y="214.52">Display CMP UI</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="107.5" y="229.6528">establish privacy status</text><path d="M13,262.7188 L456,262.7188 L456,269.7188 L446,279.7188 L13,279.7188 L13,262.7188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="755.5" x="13" y="262.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="398" x="28" y="275.7856">Permantenly store privacy status with user account</text><polygon fill="#76B82A" points="672.5,296.9844,682.5,300.9844,672.5,304.9844,676.5,300.9844" style="stroke: #76B82A; stroke-width: 1.0;"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="61.5" x2="678.5" y1="300.9844" y2="300.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="68.5" y="295.9185">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="467" x="103.5" y="295.9185">store privacy status (TC String, netID Permission) via the WRITE SERVICE</text><polygon fill="#76B82A" points="72.5,326.1172,62.5,330.1172,72.5,334.1172,68.5,330.1172" style="stroke: #76B82A; stroke-width: 1.0;"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="66.5" x2="688.5" y1="330.1172" y2="330.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="78.5" y="325.0513">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="113.5" y="325.0513">response: OK, TPID</text><line style="stroke: #76B82A; stroke-width: 1.0;" x1="61.5" x2="103.5" y1="366.25" y2="366.25"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="103.5" x2="103.5" y1="366.25" y2="379.25"/><line style="stroke: #76B82A; stroke-width: 1.0;" x1="62.5" x2="103.5" y1="379.25" y2="379.25"/><polygon fill="#76B82A" points="72.5,375.25,62.5,379.25,72.5,383.25,68.5,379.25" style="stroke: #76B82A; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="68.5" y="361.1841">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="271" x="103.5" y="361.1841">cache local status in netID Partner domain</text><!--MD5=[9033110e1839dc9ab9fa65010ab40b84]
@startuml
skinparam sequence {
	ArrowColor #76b82a
	ActorBorderColor #76b82a
    ActorBackgroundColor #FFF
	ActorFontColor #000
    ActorFontName Arial
	ActorFontSize 17

	LifeLineBorderColor #76b82a
	LifeLineBackgroundColor #76b82a
	
	ParticipantBorderColor #76b82a
	ParticipantBackgroundColor #76b82a
	ParticipantFontName Arial
	ParticipantFontSize 17
	ParticipantFontColor #FFF

}

autonumber "<b>[00]"
participant  "CMP JS" as cmp
participant  "Permission Layer" as pl
participant  "Read Service" as rs
participant  "Write Service" as ws

cmp -> cmp :  Check local/cached status \n Unknown user, no privacy status known
 group Check Status (privacy settings, user authentication)
    cmp -> rs : try to retrieve privacy status for authenticated user
    activate rs
    rs -> cmp : response - OK, CONSENT_REQUIRED, no privacy status present
    deactivate rs
    end
cmp -> cmp : Display CMP UI \n establish privacy status
Group Permantenly store privacy status with user account
cmp -> ws : store privacy status (TC String, netID Permission) via the WRITE SERVICE
activate ws
ws -> cmp : response: OK, TPID 
deactivate ws
end
cmp -> cmp : cache local status in netID Partner domain
@enduml

PlantUML version 1.2020.16beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>